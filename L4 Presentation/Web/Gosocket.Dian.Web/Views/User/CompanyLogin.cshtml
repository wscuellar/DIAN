@using Gosocket.Dian.Domain.Common
@using Gosocket.Dian.Infrastructure
@using Gosocket.Dian.Web.Models
@using Newtonsoft.Json
@model UserLoginViewModel

@{
    Layout = "~/Views/Shared/_LayoutNewLogin.cshtml";
    RecoverPasswordModel recoverPasswordModel = new RecoverPasswordModel();
    recoverPasswordModel.IdentificationTypesRecover = Model.IdentificationTypes;

}
<style>
    .bhoechie-tab-menu {
        padding: 0px !important;
    }

    .textRecovery {
        margin-top: 15px;
        margin-bottom: 15px;
        font-style: normal;
        font-size: 14px;
        line-height: 14px;
        color: #348441;
        cursor: pointer;
    }

    .btn-link-recovery {
        padding-left: 0px;
        padding-top: 2px;
        text-decoration: underline;
        color: #348441;
    }
</style>

<link href="~/Content/css/Radian/RadianIndex.css" rel="stylesheet" />

<div class="row" id="panel-forma" data-target="#panel-forma" data-toogle="panel-overlay">
    <div class="col-lg-6 col-md-6 col-sm-8 col-xs-9 bhoechie-tab-container">
        <div class="col-lg-3 col-md-3 col-sm-3 col-xs-3 bhoechie-tab-menu">
            <div class="list-group">
                <!-- admin -->
                <a href="@Url.Action("Login", "User")" class="list-group-item text-center">
                    <h4 class="glyphicon glyphicon-globe"></h4><br />@Gosocket.Dian.Domain.Common.EnumHelper.GetEnumDescription(LoginType.Administrator)
                </a>

                <!-- company -->
                <a href="@Url.Action("CompanyLogin", "User")" class="list-group-item text-center active">
                    <h4 class="glyphicon glyphicon-briefcase"></h4><br />@Gosocket.Dian.Domain.Common.EnumHelper.GetEnumDescription(LoginType.Company)
                </a>

                <!-- external user -->
                @*<a href="@Url.Action("ExternalUserLogin", "User")" class="list-group-item text-center">
                     <h4 class="glyphicon glyphicon-user"></h4><br />@Gosocket.Dian.Domain.Common.EnumHelper.GetEnumDescription(LoginType.ExternalUser)
                </a>*@

                <!-- person -->
                <a href="@Url.Action("PersonLogin", "User")" class="list-group-item text-center">
                    <h4 class="glyphicon glyphicon-user"></h4><br />@Gosocket.Dian.Domain.Common.EnumHelper.GetEnumDescription(LoginType.Person)
                </a>
 
                <!-- Not obliged to invoice -->
                @*<a href="@Url.Action("NotObligedInvoice","User")" class="list-group-item text-center">
                    <h4 class="glyphicon glyphicon-file"></h4><br />@Gosocket.Dian.Domain.Common.EnumHelper.GetEnumDescription(LoginType.NotObligedInvoice)
                </a>*@

                <!-- certificate -->
                <a href="#" class="list-group-item text-center certificate-login-link">
                    <h4 class="glyphicon glyphicon-star"></h4><br />@Gosocket.Dian.Domain.Common.EnumHelper.GetEnumDescription(LoginType.Certificate)
                </a>

                <a href="@Url.Action("SearchDocument", "User")" class="list-group-item text-center">
                    <h4 class="glyphicon glyphicon-search"></h4><br />Documento
                </a>
            </div>
                </div>
                <div class="col-lg-9 col-md-9 col-sm-9 col-xs-9 bhoechie-tab cardsLogin" style="display: none">

                    <div class="container-fluid" id="panel-form-login">
                        <center><a href=""><img alt="Dian" src="../Content/img/LogoDian.png" width="180" class=""></a></center>
                        <div class="row-fluid">
                            <div class="card RadianCardContainer RadianCardContainerLogin" id="legalRepresentative">
                                <div class="RadianImgContainer">
                                    <img class="RadianimgSvg" src="~/Content/images/Svg/RepresentanteLegal.svg" />
                                </div>
                                <div class="card-body">
                                    <p class="RadianTittleCard">Representante legal</p>
                                </div>
                            </div>
                        </div>
                        <div class="row-fluid">
                            <div class="card RadianCardContainer RadianCardContainerLogin" id="authorizedUser">
                                <div class="RadianImgContainer">
                                    <img class="RadianimgSvg" src="~/Content/images/Svg/UsuarioAutorizado.svg" />
                                </div>
                                <div class="card-body">
                                    <p class="RadianTittleCard">Usuario Autorizado</p>
                                </div>
                            </div>
                        </div>
                    </div>
                    <!-- company section -->
                    <div class="companyLogin pxLogin">

                        @Html.Partial("_companyLogin")
                    </div>
                    <!-- company section -->
                    <div class="userExLogin pxLogin">

                        @Html.Partial("_userexLogin")
                    </div>

                </div>
            </div>
        </div>


        @section Scripts
        {
            @Scripts.Render("~/bundles/jqueryval")
            <script src="https://www.google.com/recaptcha/api.js?render=@ConfigurationManager.GetValue("Recaptcha")"></script>
            <script src="~/Content/js/user/forgot-password.js"></script>
            <script src="~/Content/plugins/bootbox/bootbox.min.js"></script>
            <script src="~/Content/js/Radian/RadianIndex.js"></script>
            <script src="~/Content/js/user/exHandlerLogin.js"></script>
            <script src="~/Scripts/jquery.unobtrusive-ajax.min.js"></script>




            <script>

                $(document).ready(function () {
                    var htmlPartial = @(Html.Raw(JsonConvert.SerializeObject(Html.Partial("_forgotPasswordFormInvoice", recoverPasswordModel).ToString().Trim('"'))));
                    $(".cardsLogin").show();
                    if (location.href.indexOf('tlogin=1') > 0) {
                        showLoading("#panel-forma", "Validando datos", "Por favor esperar");
                        $(".pxLogin").hide();
                        $("#panel-form-login").hide();
                        $(".companyLogin").show();
                        hideLoading("#panel-forma");
                    }
                    else {
                            $(".pxLogin").hide();

                            $('.cCompany').click(function () {
                                $("#panel-form-login").show();
                                $(".pxLogin").hide();
                            });

                            $('#legalRepresentative').click(function () {
                                $("#panel-form-login").hide();
                                $(".companyLogin").show();
                                cleanFields();
                            });

                            $('#authorizedUser').click(function () {
                                $("#panel-form-login").hide();
                                $(".userExLogin").show();
                                cleanFields();
                            });

                            $('.certificate-login-link').click(function () {
                                window.location = '@ConfigurationManager.GetValue("CertificateLoginUrl")';
                            });

                            $('.list-group-item').click(function () {
                                cleanFields();
                            });
                    }

                    var cleanFields = function () {
                        $('.field-validation-error').html('');
                        $('#DocumentKey').val('');
                        $('#PersonCode').val('');
                        $('input[name="CompanyCode"]').val('');
                        $('input[name="UserCode"]').val('');
                        $('#Password').val('');
                    };
                    rememberPassword(htmlPartial, '@Url.Action("RecoveryPassword", "User")');
                    grecaptcha.ready(function () {
                        grecaptcha.execute('@ConfigurationManager.GetValue("Recaptcha")', { action: 'adminLogin' }).then(function (token) {
                            $(".RecaptchaToken").val(token);
                        });
                    });
                });

            </script>
        }
